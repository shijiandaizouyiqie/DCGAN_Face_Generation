# DCGAN网络实现人脸生成

### 结果展示

> 训练100个epoch的效果，基本损失就到这了，不会再进一步减小。要想实现更好更清晰的图像，就需要对网络进行进一步的改进。

![1733731302710](image/README/1733731302710.png)

### 数据集

CelebA数据集

[下载链接](https://mmlab.ie.cuhk.edu.hk/projects/CelebA.html)

### 预处理

由于数据集较大（20w张图片），训练中，Dataloader读取数据集时才对图片进行resize等预处理操作，会出现CPU瓶颈的现象。即预处理操作使得CPU占用率特别高，大量的时间耗费在对图片进行预处理上，导致训练速度较慢，GPU占用率很低。

所以建议下载好数据集之后，先使用 `img_resize_to_64x64.py`提前将数据集裁剪为64x64大小的图片保存到新文件夹中。然后训练时只需要将图片转化为`Tensor`，这样Dataloader读取数据集会快很多，加快训练速度。
然后还在Dataloader中进行了一定的加快速度的处理。
> 对于这种大型数据集，如何加快训练速度，避免CPU瓶颈的现象本人研究的不多，后面如果了解到更好的方法会回来尝试一下。

### 训练和测试

`dcgan_me.py`

将最下方的 `TRAIN `标志位置1进行训练，`TEST `标志位置1测试效果。

> 具体训练相关的超参数在 `train()`函数中调整
